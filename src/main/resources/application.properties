# ===================================================================
# CONFIGURACION LOCAL DE LA BASE DE DATOS (USANDO CONNECTION POOLER)
# ===================================================================

# URL de conexion al Pooler de Supabase
spring.datasource.url=jdbc:postgresql://aws-1-sa-east-1.pooler.supabase.com:5432/postgres

# El 'username' para el Pooler incluye el ID del proyecto
spring.datasource.username=postgres.bdyvzjpkycnekjrlqlfp

# La contrasena se inyecta de forma segura desde una variable de entorno
spring.datasource.password=${SUPABASE_DB_PASSWORD}


# ===================================================================
# CONFIGURACION DE JPA & HIBERNATE
# ===================================================================

# Muestra las consultas SQL en la consola durante el desarrollo
spring.jpa.show-sql=true

# Estrategia de generacion de esquema. 'update' es ideal para desarrollo.
spring.jpa.hibernate.ddl-auto=update

# Mantiene los nombres de las columnas igual que en las entidades (camelCase)
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# Desactiva Open-In-View para promover buenas practicas y mejorar el rendimiento
spring.jpa.open-in-view=false

# ===================================================================
# CONFIGURACION DE SEGURIDAD (SUPABASE AUTH)
# ===================================================================
spring.security.oauth2.resourceserver.jwt.issuer-uri=${SUPABASE_JWT_ISSUER_URI}

# ===================================================================
# CONFIGURACION DE MONITOREO Y RENDIMIENTO
# ===================================================================

# Actuator Configuration for Monitoring
management.endpoints.web.exposure.include=health,metrics,prometheus,info
management.endpoint.health.show-details=when-authorized

# Custom metrics configuration
management.metrics.tags.application=ioc-backend
management.metrics.tags.version=@project.version@

# Circuit Breaker Configuration
resilience4j.circuitbreaker.instances.notification-service.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.notification-service.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.notification-service.sliding-window-size=10
resilience4j.circuitbreaker.instances.notification-service.minimum-number-of-calls=5

# Cache Configuration for Rate Limiting
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=60m
