# ===================================================================
# PRODUCCIÃ“N - RENDER DEPLOYMENT
# ===================================================================

# Database Connection
spring.datasource.url=jdbc:postgresql://aws-1-sa-east-1.pooler.supabase.com:5432/postgres?reWriteBatchedInserts=true&prepareThreshold=0&preferQueryMode=simple&sslmode=require
spring.datasource.username=postgres.bdyvzjpkycnekjrlqlfp
spring.datasource.password=${SUPABASE_DB_PASSWORD}

# HikariCP Pool - Production Optimized
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=240000
spring.datasource.hikari.max-lifetime=300000
spring.datasource.hikari.keepalive-time=120000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.leak-detection-threshold=120000
spring.datasource.hikari.pool-name=SupabaseHikariPool-Prod
spring.datasource.hikari.data-source-properties.applicationName=iocbackend-prod

# JPA/Hibernate - PRODUCTION (DO NOT MODIFY SCHEMA)
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.open-in-view=false

# Security
spring.security.oauth2.resourceserver.jwt.issuer-uri=${SUPABASE_JWT_ISSUER_URI:https://bdyvzjpkycnekjrlqlfp.supabase.co/auth/v1}

# ===================================================================
# SUPABASE AUTH API - For automatic user creation
# ===================================================================
supabase.url=${SUPABASE_URL:https://bdyvzjpkycnekjrlqlfp.supabase.co}
supabase.service-role-key=${SUPABASE_SERVICE_ROLE_KEY}

# Metabase
metabase.site-url=${METABASE_URL:https://treated-paste-eos-memo.trycloudflare.com}
metabase.secret-key=${METABASE_SECRET_KEY:dummy-key-for-local-prod-testing}

# ETL
etl.lock.enabled=false
etl.duplicate.check.enabled=false
etl.duplicate.fail-on-detect=false

# Logging (Production)
logging.level.com.cambiaso.ioc=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN

# CORS: allowed origins (comma-separated). Use patterns like https://*.vercel.app for Vercel previews.
# Override in production by setting env var or editing this property in the deployment config.
# Example: app.cors.allowed-origins=http://localhost:3000,https://myapp.vercel.app,https://*.vercel.app
app.cors.allowed-origins=http://localhost:3000,http://localhost:5173,https://*.vercel.app
