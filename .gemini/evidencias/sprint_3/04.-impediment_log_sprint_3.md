# Registro de Impedimentos del Sprint 3 (v2.0)

**Proyecto:** IOC (Indicadores Operacionales Cambiaso)  
**Sprint:** Sprint 3 - El Poder de la Gobernanza  
**Per√≠odo:** 27 Octubre - 18 Noviembre 2025 (17 d√≠as laborables, sin festivos)  
**Equipo:**

- Boris Arriagada (Product Owner + Developer)
- Jaime Vicencio (Scrum Master + Developer)

---

## üìä Estado Actual

| M√©trica                           | Valor                |
| --------------------------------- | -------------------- |
| **Total de Impedimentos**         | 7                    |
| **Resueltos**                     | 7 (100%)             |
| **Pendientes**                    | 0                    |
| **Tiempo Promedio de Resoluci√≥n** | 2.0 d√≠as             |
| **Impedimentos Cr√≠ticos**         | 2 (IMP-019, IMP-021) |
| **Impedimentos de Alto Impacto**  | 3                    |
| **Impedimentos de Impacto Medio** | 2                    |

---

## Proceso de Gesti√≥n de Impedimentos

1. **Identificaci√≥n:** Cualquier miembro del equipo reporta el impedimento en la Daily Scrum.
2. **Clasificaci√≥n:** Se asigna ID, impacto (üî¥ Cr√≠tico / üü° Alto / üü¢ Medio) y responsable.
3. **An√°lisis:** Se define plan de acci√≥n, causa ra√≠z y acci√≥n preventiva.
4. **Seguimiento:** El estado se actualiza diariamente hasta su resoluci√≥n.
5. **Cierre:** Se documenta la soluci√≥n y se calcula el tiempo de resoluci√≥n.

---

## üìã Registro de Impedimentos Resueltos

| ID          | Impacto    | Impedimento                                                                                                                                                                                                                                                                                                 | Responsable | Detectado | Resuelto | D√≠as | Soluci√≥n Aplicada                                                                                                                                                                                                                                                  | Causa Ra√≠z                                                                                                                                                                                                                                  | Acci√≥n Preventiva                                                                                                                                                                                                                                                                 |
|:----------- |:----------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |:----------- |:---------:|:--------:|:----:|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **IMP-017** | üü° Alto    | **Complejidad de permisos granulares requiere refactorizaci√≥n del modelo:** El modelo RBAC inicial era insuficiente para soportar permisos granulares requeridos por requisitos de seguridad empresarial.                                                                                                   | Jaime       | 29-Oct    | 31-Oct   | 2    | Dise√±ar e implementar arquitectura RBAC mejorada con sistema de permisos granulares completo, incluyendo refactorizaci√≥n del modelo de datos y controladores administrativos.                                                                                      | **Planificaci√≥n Insuficiente:** El dise√±o inicial de RBAC no contempl√≥ la complejidad real de los requisitos de permisos granulares a nivel de recursos espec√≠ficos (dashboards, gr√°ficos individuales).                                    | **Arquitectura de Referencia:** Crear documento de decisiones arquitect√≥nicas (ADR) para sistemas RBAC que incluya matriz de permisos, ejemplos de casos de uso complejos y patrones de dise√±o validados antes de implementaci√≥n.                                                 |
| **IMP-018** | üü¢ Medio   | **Validaci√≥n de SKUs inexistentes con performance insuficiente:** La validaci√≥n de existencia de SKUs en el proceso ETL generaba consultas individuales por cada registro, causando cuello de botella con archivos grandes.                                                                                 | Boris       | 30-Oct    | 31-Oct   | 1    | Implementar soluci√≥n de cach√© LRU (Least Recently Used) con Caffeine para precarga de cat√°logo de SKUs v√°lidos en memoria, reduciendo consultas a base de datos significativamente.                                                                                | **Falta de Optimizaci√≥n Proactiva:** No se realiz√≥ an√°lisis de performance con vol√∫menes reales de datos durante la fase de dise√±o de la funcionalidad de validaci√≥n.                                                                       | **Performance Testing Temprano:** Incluir en Definition of Ready (DoR) para historias de procesamiento masivo de datos: "Debe validarse performance con dataset representativo antes de marcar como Ready".                                                                       |
| **IMP-019** | üî¥ Cr√≠tico | **Sincronizaci√≥n con Supabase Auth genera conflictos de estado:** Conflictos de sincronizaci√≥n entre tabla local `app_users` y sistema autoritativo `supabase.auth.users` causaban inconsistencias al crear o modificar usuarios desde el panel de administraci√≥n.                                          | Jaime       | 3-Nov     | 5-Nov    | 2    | Implementar sincronizaci√≥n bidireccional utilizando webhooks de Supabase Auth para garantizar consistencia eventual con trazabilidad completa.                                                                                                                     | **Dise√±o de Integraci√≥n Incompleto:** No se consider√≥ que Supabase Auth es el sistema autoritativo y que cambios manuales directos en `app_users` pueden causar desincronizaci√≥n de estados.                                                | **Principio de Source of Truth:** Establecer como regla de arquitectura: "Todo sistema de autenticaci√≥n externo es la √∫nica fuente de verdad. Cambios locales deben propagarse mediante webhooks o sincronizaci√≥n autom√°tica con mecanismo de retry".                             |
| **IMP-020** | üü¢ Medio   | **Spring Security Rules conflict√∫an con endpoints admin:** Los endpoints de administraci√≥n `/api/v1/admin/**` retornaban error `403 Forbidden` a usuarios con rol `ROLE_ADMIN` debido a configuraci√≥n incorrecta del orden de reglas en `SecurityFilterChain`.                                              | Jaime       | 6-Nov     | 7-Nov    | 1    | Ajustar configuraci√≥n en `SecurityConfig.java` para agregar regla expl√≠cita `requestMatchers("/api/v1/admin/**").hasRole("ADMIN")` antes de la regla gen√©rica `anyRequest().authenticated()`, respetando orden de precedencia.                                     | **Orden de Precedencia en Spring Security:** Las reglas de seguridad se eval√∫an secuencialmente. La regla gen√©rica bloqueaba el acceso antes de evaluar los permisos espec√≠ficos de administrador.                                          | **Revisi√≥n de Security Config:** A√±adir checklist de revisi√≥n obligatoria para configuraciones de Spring Security: 1) Reglas espec√≠ficas primero, 2) Reglas gen√©ricas al final, 3) Testing con m√∫ltiples roles diferentes.                                                        |
| **IMP-021** | üî¥ Cr√≠tico | **Metabase requiere HTTPS para firmar JWT de embedding:** La instancia EC2 que aloja Metabase solo expone HTTP, pero el backend en Render (HTTPS) requiere comunicaci√≥n segura para validar y firmar tokens JWT de embedding de dashboards. Imposibilita verificaci√≥n de `dashboard_id` y embedding seguro. | Boris       | 7-Nov     | 11-Nov   | 4    | Implementar **Cloudflare Tunnel** para exponer la instancia EC2 de Metabase con certificado SSL/TLS autom√°tico, permitiendo comunicaci√≥n HTTPS end-to-end. Configurar tunnel con dominio personalizado y actualizar `METABASE_SITE_URL` a URL HTTPS.               | **Requisito de HTTPS para JWT:** No se consider√≥ que la firma de tokens JWT para embedding de Metabase requiere protocolo HTTPS obligatorio. Instancias EC2 sin ELB/ALB solo exponen HTTP, incompatible con requisitos de seguridad de JWT. | **Validaci√≥n de Requisitos de Seguridad:** Para integraciones con servicios que requieren autenticaci√≥n JWT o tokens firmados, validar en spike t√©cnico: protocolo HTTPS obligatorio, certificados SSL/TLS, y configuraci√≥n de t√∫neles seguros (Cloudflare Tunnel, ngrok, o ALB). |
| **IMP-022** | üü° Alto    | **JSON Schema validation para layout_config genera errores:** La validaci√≥n de estructura JSON compleja de layouts de dashboard con m√∫ltiples niveles de componentes anidados fallaba con mensajes de error gen√©ricos e inespec√≠ficos de Jackson.                                                           | Jaime       | 11-Nov    | 13-Nov   | 2    | Implementar validador custom utilizando Jackson `JsonNode` + esquema recursivo para validar estructura completa de componentes anidados (grid ‚Üí rows ‚Üí components ‚Üí config) con mensajes de error descriptivos y espec√≠ficos.                                      | **Complejidad de Estructura JSON:** El esquema de `layout_config` tiene m√∫ltiples niveles de anidamiento con estructura compleja, superando la capacidad de validaci√≥n est√°ndar de anotaci√≥n `@Valid` de Spring.                            | **Esquemas JSON Documentados:** Para toda estructura JSON compleja (3+ niveles de anidamiento), crear archivo de JSON Schema formal con ejemplos completos y validarlo con herramientas especializadas antes de implementar validaci√≥n en c√≥digo.                                 |
| **IMP-023** | üü° Alto    | **Simulaci√≥n de permisos por rol requiere SecurityContext manual:** La funcionalidad "Previsualizar dashboard como Rol X" requer√≠a modificaci√≥n manual del `SecurityContext` de Spring Security, introduciendo complejidad t√©cnica significativa y potenciales riesgos de seguridad.                        | Jaime       | 13-Nov    | 15-Nov   | 2    | Implementar approach alternativo sin modificar `SecurityContext`: crear m√©todo `LayoutService.previewAsRole(layoutId, roleName)` que simula permisos aplicando filtros de componentes seg√∫n los permisos del rol especificado, sin tocar el contexto de seguridad. | **Dise√±o de Seguridad Restrictivo:** Spring Security est√° dise√±ado deliberadamente para no permitir modificaci√≥n f√°cil del `SecurityContext` por razones de seguridad, y forzar este cambio genera riesgos y antipatrones.                  | **Simulaci√≥n sin Modificaci√≥n de Contexto:** Para funcionalidades de tipo "ver como otro usuario/rol", implementar l√≥gica de filtrado y simulaci√≥n en capa de servicio sin modificar `SecurityContext`. Documentar este patr√≥n en gu√≠a de desarrollo del equipo.                  |

---

## üìä Resumen y M√©tricas

### Distribuci√≥n por Impacto

| Impacto        | Cantidad | Porcentaje | Tiempo Promedio de Resoluci√≥n |
| -------------- | -------- | ---------- | ----------------------------- |
| üî¥ **Cr√≠tico** | 2        | 28.6%      | 3.0 d√≠as                      |
| üü° **Alto**    | 3        | 42.9%      | 2.0 d√≠as                      |
| üü¢ **Medio**   | 2        | 28.6%      | 1.0 d√≠a                       |
| **TOTAL**      | **7**    | **100.0%** | **2.0 d√≠as**                  |

### Velocidad de Resoluci√≥n

- **M√°s r√°pido:** IMP-018, IMP-020 (1 d√≠a cada uno)
- **M√°s lento:** IMP-021 (4 d√≠as - requiri√≥ configuraci√≥n compleja de CORS + proxy inverso)
- **Promedio general:** 2.0 d√≠as
- **Mediana:** 2.0 d√≠as

### Distribuci√≥n por Responsable

| Responsable          | Impedimentos Resueltos | Porcentaje |
| -------------------- | ---------------------- | ---------- |
| **Jaime (SM + Dev)** | 5                      | 71.4%      |
| **Boris (PO + Dev)** | 2                      | 28.6%      |

### Distribuci√≥n por Categor√≠a T√©cnica

| Categor√≠a                   | Cantidad | Ejemplos                           |
| --------------------------- | -------- | ---------------------------------- |
| **Backend/Infraestructura** | 4        | IMP-018, IMP-019, IMP-020, IMP-021 |
| **Arquitectura/Dise√±o**     | 3        | IMP-017, IMP-022, IMP-023          |
| **Seguridad/RBAC**          | 3        | IMP-017, IMP-020, IMP-023          |
| **Integraci√≥n Externa**     | 2        | IMP-019, IMP-021                   |

### Evoluci√≥n Temporal

| Semana                   | Nuevos | Resueltos | Acumulados |
| ------------------------ | ------ | --------- | ---------- |
| **Semana 1** (27-31 Oct) | 2      | 2         | 0          |
| **Semana 2** (3-7 Nov)   | 3      | 3         | 0          |
| **Semana 3** (10-14 Nov) | 2      | 2         | 0          |
| **Semana 4** (17-22 Nov) | 0      | 0         | 0          |

---

## üéì Top 3 Lecciones Aprendidas

### 1. **Las Integraciones con Servicios Externos Son Siempre M√°s Complejas de lo Estimado** (IMP-019, IMP-021)

- **Impacto:** Los 2 impedimentos cr√≠ticos del sprint fueron causados por integraciones externas (Supabase Auth, Metabase API), consumiendo 6 d√≠as-persona totales (2 + 4 d√≠as).
- **Lecci√≥n:** Toda integraci√≥n con servicios externos (autenticaci√≥n, APIs, webhooks) requiere spike t√©cnico que valide configuraci√≥n de CORS, autenticaci√≥n, sincronizaci√≥n de estado, rate limiting y manejo de errores.
- **Acci√≥n:** A√±adir al Definition of Ready: "Para historias con integraci√≥n externa nueva, debe existir spike t√©cnico documentado (m√°ximo 1 d√≠a) con pruebas exitosas de conectividad y casos de error antes de planificar la historia completa".

### 2. **La Arquitectura de Seguridad Requiere Dise√±o Completo Anticipado, No Iterativo** (IMP-017, IMP-020, IMP-023)

- **Impacto:** 3 de 7 impedimentos (42.9%) estuvieron relacionados con arquitectura de seguridad y RBAC, bloqueando desarrollo por 6 d√≠as totales (2 + 1 + 2 d√≠as).
- **Lecci√≥n:** Sistemas de seguridad empresarial (RBAC granular, Spring Security, simulaci√≥n de roles) deben dise√±arse completamente antes de implementaci√≥n iterativa, considerando casos de uso complejos desde el inicio.
- **Acci√≥n:** Para Sprint 4 y futuros proyectos, incluir fase de "Security Architecture Review" de 1 d√≠a completo antes de iniciar implementaci√≥n de historias con componentes de seguridad cr√≠tica, con validaci√≥n de PO y SM.

### 3. **La Validaci√≥n de Estructuras Complejas Requiere Herramientas Especializadas** (IMP-022)

- **Impacto:** Validaci√≥n de JSON complejo bloque√≥ 2 d√≠as y requiri√≥ implementaci√≥n custom que pudo haberse evitado con an√°lisis previo.
- **Lecci√≥n:** Estructuras de datos con 3+ niveles de anidamiento (layouts, configuraciones complejas) no pueden validarse eficientemente solo con anotaciones est√°ndar de Spring, requieren JSON Schema formal o librer√≠as especializadas.
- **Acci√≥n:** A√±adir al DoD: "Para estructuras JSON con 3+ niveles de anidamiento, debe existir JSON Schema formal (.json) con ejemplos validados y librer√≠a de validaci√≥n espec√≠fica (ej: json-schema-validator) antes de marcar como Done".

---

## üìä Comparaci√≥n con Sprint 1 y Sprint 2

| M√©trica                               | Sprint 1  | Sprint 2  | Sprint 3  | Tendencia S2‚ÜíS3 | An√°lisis                                                                                                                                                               |
| ------------------------------------- | --------- | --------- | --------- | --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Total Impedimentos**                | 16        | 4         | 7         | ‚¨ÜÔ∏è **+75%**     | Aumento respecto a Sprint 2, pero 56% mejor que Sprint 1. El incremento se debe a mayor complejidad t√©cnica del sprint (RBAC granular, integraciones externas).        |
| **Tiempo Promedio Resoluci√≥n**        | 1.2 d√≠as  | 1.1 d√≠as  | 2.0 d√≠as  | ‚¨ÜÔ∏è **+82%**     | Aumento significativo debido a impedimentos m√°s complejos (IMP-021: 4 d√≠as). Impedimentos cr√≠ticos de integraci√≥n externa requieren m√°s tiempo de an√°lisis y soluci√≥n. |
| **Impedimentos Cr√≠ticos**             | 4 (25%)   | 1 (25%)   | 2 (28.6%) | ‚¨ÜÔ∏è **+14%**     | Ligero aumento en porcentaje. Ambos cr√≠ticos vinculados a integraciones externas (Supabase Auth, Metabase API). Mayor complejidad t√©cnica del Sprint 3.                |
| **Impedimentos de Alto Impacto**      | 6 (37.5%) | 2 (50%)   | 3 (42.9%) | ‚¨áÔ∏è **-14%**     | Reducci√≥n en porcentaje respecto a Sprint 2. Los 3 altos est√°n relacionados con arquitectura de seguridad (RBAC, Spring Security, simulaci√≥n de roles).                |
| **Impedimentos Prevenidos**           | 0         | 1 (R-005) | 0         | ‚¨áÔ∏è **-100%**    | No se identificaron riesgos materializables en Sprint 3. El sprint se enfoc√≥ en gobernanza y seguridad, √°reas con menor incertidumbre t√©cnica.                         |
| **Velocidad de Resoluci√≥n (Mediana)** | 1 d√≠a     | 1 d√≠a     | 2.0 d√≠as  | ‚¨ÜÔ∏è **+100%**    | Duplicaci√≥n de la mediana debido a complejidad de impedimentos. 50% de impedimentos tomaron 2+ d√≠as (vs 25% en Sprint 1-2).                                            |
| **Categor√≠a Dominante**               | Diversos  | Frontend  | Backend   | üîÑ **Cambio**   | Sprint 3 fue dominado por impedimentos de backend/integraci√≥n (57%). Refleja enfoque en APIs externas y arquitectura de seguridad.                                     |

**Conclusi√≥n de Tendencias:**

- ‚ö†Ô∏è **Aumento esperado:** Los impedimentos aumentaron de 4 a 7 (+75%) debido a mayor complejidad t√©cnica del Sprint 3 (gobernanza, RBAC, integraciones externas)
- ‚ö†Ô∏è **Complejidad mayor:** Tiempo promedio de resoluci√≥n aument√≥ 82% (1.1 ‚Üí 2.0 d√≠as), reflejando impedimentos m√°s complejos que requieren an√°lisis profundo
- ‚úÖ **Mejora vs Sprint 1:** A pesar del incremento, Sprint 3 mantiene 56% menos impedimentos que Sprint 1 (7 vs 16), demostrando madurez del equipo
- üî¥ **Impedimentos cr√≠ticos:** 2 cr√≠ticos en Sprint 3 (Supabase Auth, Metabase CORS) consumieron 6 d√≠as totales, impactando velocidad del sprint
- ‚úÖ **Patr√≥n identificado:** Integraciones externas son la principal fuente de impedimentos cr√≠ticos (IMP-019, IMP-021). Spike t√©cnico preventivo es esencial.
- ‚ö†Ô∏è **√Årea de mejora:** Arquitectura de seguridad gener√≥ 3 impedimentos (42.9%). Dise√±o arquitect√≥nico completo antes de implementaci√≥n es cr√≠tico.
- üìä **Evoluci√≥n general:** Sprint 1 (16 imp) ‚Üí Sprint 2 (4 imp) ‚Üí Sprint 3 (7 imp). Tendencia positiva con variaci√≥n seg√∫n complejidad del sprint.

---

## üìã Leyenda

### Impacto

- üî¥ **Cr√≠tico:** Bloque√≥ trabajo completamente, puso en riesgo el Sprint Goal o caus√≥ fallas del sistema.
- üü° **Alto:** Impacto significativo en la productividad o calidad, pero hab√≠a workaround temporal.
- üü¢ **Medio:** Molestia o ineficiencia que ralentiz√≥ el trabajo, pero no fue bloqueante.

### Estados

- ‚úÖ **Resuelto:** El impedimento fue completamente resuelto y la soluci√≥n fue validada.
- üîÑ **En Progreso:** Se est√° trabajando activamente en la resoluci√≥n.
- üÜï **Nuevo:** Impedimento identificado pero a√∫n no se inici√≥ el plan de acci√≥n.

### Duraci√≥n

- **<1 d√≠a:** Resuelto en el mismo d√≠a (2-4 horas t√≠picamente)
- **1 d√≠a:** Resuelto en un d√≠a laborable completo
- **2+ d√≠as:** Requiri√≥ m√∫ltiples d√≠as de trabajo (casos complejos o cr√≠ticos)

---

**√öltima actualizaci√≥n:** 22 Noviembre 2025 - Post Sprint Review  
**Pr√≥xima revisi√≥n:** Sprint 4 Planning (25 Noviembre 2025)

---

**Documentos relacionados:**

- Sprint Backlog: `01.-sprint_3_backlog_completado.md`
- Daily Scrum Summary: `03.-daily_scrum_summary_sprint_3_18_nov.md`
- Project Summary: `project-summary.md`
- Impediment Log Sprint 1: `04.-impediment_log_sprint_1.md`
- Impediment Log Sprint 2: `04.-impediment_log_sprint_2_FORMATO_TABLA.md`
