## Sprint Demo - Sprint 3

**Proyecto:** IOC (Inteligencia Operacional Cambiaso)  
**Fecha:** 18 Noviembre 2025  
**Duración:** 30 minutos  
**Asistentes:** 2 personas (Boris Arriagada - PO/Dev, Jaime Vicencio - SM/Dev)

---



## Resumen Rápido

| Métrica         | Planeado | Completado | %    |
|:--------------- |:-------- |:---------- |:---- |
| Historias       | 4        | 4          | 100% |
| Story Points    | 37       | 37         | 100% |
| Tareas Técnicas | 70       | 70         | 100% |
| Sprint Goal     | -        | Alcanzado  | -    |

**Sprint Goal:** Completar el MVP otorgando al Administrador control total sobre la validación de datos, gestión de usuarios, roles, permisos y administración completa del contenido analítico (gráficos y disposición de dashboards), estableciendo una plataforma de BI completamente gobernada y lista para producción. **COMPLETADO**

---

## Funcionalidades Demostradas

### Módulo 1: Validación Automática de Datos (IOC-002)

| ID         | Funcionalidad                                           | Status |
|:---------- |:------------------------------------------------------- |:------ |
| IOC-002-01 | Carga masiva CSV con validación en tiempo real          | ✅      |
| IOC-002-02 | Reglas de validación configurables por el Administrador | ✅      |
| IOC-002-03 | Dashboard de errores con filtros avanzados              | ✅      |
| IOC-002-04 | Exportación de reportes de validación (PDF/Excel)       | ✅      |

**Escenario de Demostración (Simulado):**

1. **Carga de archivo CSV** (basado en criterios de aceptación)
   
   - Archivo de ejemplo con datos operacionales
   - Sistema detecta automáticamente el formato y valida estructura
   - Progreso en tiempo real: barra de carga, registros procesados, errores detectados

2. **Resultados de validación**
   
   - Dashboard muestra: 950 registros válidos, 50 con errores
   - Tipos de errores clasificados: formato de fecha inválido, campos obligatorios faltantes, rangos numéricos fuera de límite
   - Vista detallada por registro con sugerencias de corrección

3. **Reglas de validación personalizadas**
   
   - Administrador accede al módulo de configuración
   - Crea regla: "Monto debe estar entre $1,000 y $1,000,000"
   - Asigna prioridad (crítica/advertencia) y mensaje de error personalizado

4. **Exportación de reportes**
   
   - Genera reporte en PDF con resumen ejecutivo
   - Exporta registros con errores a Excel para corrección offline
   - Incluye metadatos: fecha de carga, usuario, archivo origen

**Características técnicas destacadas:**

- Validación en streaming para archivos grandes (objetivo: <30 segundos para 1,000 registros)
- Webhooks bidireccionales para sincronización con Supabase (según IMP-019)
- Reglas de validación persistidas en PostgreSQL con versionado

---

### Módulo 2: Gestión de Usuarios y Roles (IOC-004)

| ID         | Funcionalidad                                           | Status |
|:---------- |:------------------------------------------------------- |:------ |
| IOC-004-01 | CRUD completo de usuarios con validación de datos       | ✅      |
| IOC-004-02 | Sistema RBAC con permisos granulares                    | ✅      |
| IOC-004-03 | Interfaz de asignación de roles con preview de permisos | ✅      |
| IOC-004-04 | Auditoría de cambios en usuarios y permisos             | ✅      |

**Escenario de Demostración (Simulado):**

1. **Creación de usuario**
   
   - Formulario con validación en tiempo real
   - Campos: nombre, email, rol inicial, estado (activo/inactivo)
   - Sistema previene duplicados y valida formato de email

2. **Asignación de roles y permisos**
   
   - Roles predefinidos: Administrador, Gerente, Analista
   - Permisos granulares organizados por módulo
   - Preview en tiempo real: "Con este rol, el usuario podrá: ver dashboards, crear reportes, NO podrá: modificar usuarios, cambiar configuración"

3. **Sistema RBAC en acción**
   
   - Login con rol "Gerente"
   - Menú de navegación muestra solo opciones permitidas
   - Intento de acceso a función restringida: mensaje "Acceso denegado - requiere permiso: admin.users.manage"

4. **Auditoría completa**
   
   - Log de eventos: "Usuario Administrador creó cuenta de Analista"
   - Timestamps, IP de origen, cambios realizados (antes/después)
   - Filtros por tipo de acción, usuario, rango de fechas

**Características técnicas destacadas:**

- Sistema RBAC con arquitectura de 4 capas (según solución IMP-017)
- Permisos granulares por módulo funcional
- Integración con Supabase Auth para SSO
- Caché de permisos con invalidación automática

---

### Módulo 3: Gestión de Gráficos (IOC-019)

| ID         | Funcionalidad                              | Status |
|:---------- |:------------------------------------------ |:------ |
| IOC-019-01 | CRUD de gráficos con 8 tipos disponibles   | ✅      |
| IOC-019-02 | Editor visual de configuración de gráficos | ✅      |
| IOC-019-03 | Preview en tiempo real con datos reales    | ✅      |
| IOC-019-04 | Versionado de configuraciones de gráficos  | ✅      |

**Tipos de gráficos disponibles:**

- Line Chart (series temporales)
- Bar Chart (comparaciones)
- Pie Chart (distribuciones)
- Area Chart (acumulados)
- Scatter Plot (correlaciones)
- Heatmap (matrices de calor)
- Gauge (indicadores KPI)
- Table (datos tabulares con formato)

**Escenario de Demostración (Simulado):**

1. **Creación de gráfico**
   
   - Administrador selecciona tipo: "Bar Chart"
   - Asigna nombre: "Ventas por Región"
   - Configura fuente de datos: tabla operacional, query predefinida

2. **Editor visual**
   
   - Panel izquierdo: configuración
     - Ejes X/Y: selección de campos
     - Colores: paleta predefinida o personalizada
     - Leyendas: posición, formato
   - Panel derecho: preview en tiempo real
     - Actualización automática al cambiar configuración
     - Datos reales desde base de datos
     - Indicador de carga mientras actualiza

3. **Configuración avanzada**
   
   - Filtros dinámicos: fecha, región, producto
   - Agregaciones: sum, avg, count, min, max
   - Formato de números: moneda, porcentaje, decimal
   - Umbrales visuales: líneas de objetivo, zonas de alerta

4. **Versionado**
   
   - Sistema guarda cada cambio con timestamp
   - Historial: "Versión 1.0", "Versión 1.1 - cambió color de series"
   - Rollback: restaurar versión anterior con un click

**Características técnicas destacadas:**

- Gráficos basados en Metabase embebido
- Configuración JSON Schema validada (según solución IMP-022)
- Preview con datos reales (objetivo: carga <3 segundos)
- Versionado con Git-like diff

---

### Módulo 4: Diseño de Layout de Dashboards (IOC-020)

| ID         | Funcionalidad                                          | Status |
|:---------- |:------------------------------------------------------ |:------ |
| IOC-020-01 | Editor drag-and-drop para organizar gráficos           | ✅      |
| IOC-020-02 | Grid system responsivo con 12 columnas                 | ✅      |
| IOC-020-03 | Persistencia automática con debounce                   | ✅      |
| IOC-020-04 | Vista previa multi-dispositivo (desktop/tablet/mobile) | ✅      |

**Escenario de Demostración (Simulado):**

1. **Editor de layout**
   
   - Canvas con grid de 12 columnas visible
   - Panel lateral con gráficos disponibles
   - Drag-and-drop: arrastrar gráfico "Ventas por Región" al canvas
   - Resize: ajustar ancho y alto con handles en esquinas

2. **Organización visual**
   
   - Gráfico 1 (gauge KPI): columnas 1-3, fila 1
   - Gráfico 2 (line chart): columnas 4-12, fila 1
   - Gráfico 3 (bar chart): columnas 1-6, fila 2
   - Gráfico 4 (table): columnas 7-12, fila 2
   - Grid guides visuales para alineación perfecta

3. **Persistencia automática**
   
   - Indicador: "Guardando..." mientras arrastra
   - "Guardado" aparece después de 500ms de inactividad (objetivo: <1 segundo)
   - Sin botón "Guardar" manual - autosave continuo

4. **Preview multi-dispositivo**
   
   - Toggle desktop/tablet/mobile
   - Layout se ajusta automáticamente según breakpoints
   - En mobile: gráficos se apilan verticalmente (1 columna)
   - Administrador ve exactamente cómo verán los usuarios finales

**Características técnicas destacadas:**

- React Grid Layout para drag-and-drop
- Sistema de versionado de layouts (según lección aprendida de Retrospectiva)
- Debounce de guardado (objetivo: <1 segundo)
- Responsive design con 3 breakpoints (desktop/tablet/mobile)

---

## Impedimentos Resueltos Durante el Sprint

| ID      | Impedimento                                  | Impacto | Días | Solución                  |
|:------- |:-------------------------------------------- |:------- |:---- |:------------------------- |
| IMP-017 | Complejidad en permisos RBAC cascada         | Alto    | 2    | Arquitectura de 4 capas   |
| IMP-018 | Timeout en carga masiva CSV (>10k registros) | Medio   | 1    | Streaming + workers async |
| IMP-019 | Sincronización Supabase Auth con DB local    | Alto    | 2    | Webhooks bidireccionales  |
| IMP-020 | Gráficos no renderizaban en modal            | Medio   | 1    | Resize observer + timeout |
| IMP-021 | Metabase requiere HTTPS para embed JWT       | Crítico | 4    | Cloudflare Tunnel         |
| IMP-022 | Validación inconsistente en editor gráficos  | Alto    | 2    | JSON Schema + Ajv         |
| IMP-023 | Race condition en guardado layout            | Alto    | 2    | Debounce + optimistic UI  |

**Tiempo promedio de resolución:** 2.0 días  
**Tasa de resolución:** 100% (7/7)

**Impedimentos destacados:**

- **IMP-021 (Crítico - 4 días):** Metabase embebido requería HTTPS para validar JWT. Solución: Cloudflare Tunnel configurado en ambiente de desarrollo, generando dominio con SSL automático.

- **IMP-019 (Alto - 2 días):** Usuarios creados en Supabase no se sincronizaban con DB local. Solución: Sistema de webhooks bidireccionales - Supabase notifica creación → Backend crea registro local → Callback confirma.

- **IMP-017 (Alto - 2 días):** Permisos RBAC con herencia generaban conflictos. Solución: Refactorización a arquitectura de 4 capas (Usuario → Rol → Grupo de Permisos → Permiso Individual).

---

## Métricas Técnicas

### Rendimiento (Objetivos del Sprint Backlog)

| Métrica                         | Objetivo     | Notas                  |
|:------------------------------- |:------------ |:---------------------- |
| Validación ETL (1000 registros) | <30 segundos | Según criterio IOC-002 |
| Endpoints administración (P95)  | <500ms       | Según criterio IOC-004 |
| Carga inicial editor dashboard  | <3 segundos  | Según criterio IOC-020 |
| Guardado layout (debounce)      | <1 segundo   | Según criterio IOC-020 |

### Cobertura de Tests

| Módulo                          | Objetivo           | Notas                |
|:------------------------------- |:------------------ |:-------------------- |
| Backend (código nuevo)          | >75%               | Según Sprint Backlog |
| Frontend (componentes críticos) | >70%               | Según Sprint Backlog |
| Tests E2E                       | Flujos principales | Según Sprint Backlog |

**Nota:** Las métricas de rendimiento representan los objetivos técnicos definidos en el Sprint Backlog. Las mediciones reales requieren ejecución en ambiente de staging con JaCoCo y herramientas de profiling.

---

## Tecnologías Utilizadas

**Backend:**

- Java 17 + Spring Boot 3.1
- PostgreSQL 15 (datos transaccionales)
- Supabase (autenticación y storage)
- JWT para seguridad
- Webhooks bidireccionales para sincronización

**Frontend:**

- React 18 con TypeScript
- Vite (build tool)
- TanStack Query para state management
- React Grid Layout (drag-and-drop)
- Metabase embebido (visualizaciones)
- Tailwind CSS

**DevOps:**

- Docker + Docker Compose
- Cloudflare Tunnel (HTTPS en desarrollo)
- GitHub Actions (CI/CD)

---

## Estructura de Permisos RBAC

**Roles predefinidos:**

1. **Administrador**
   
   - Permisos totales: gestión de usuarios, configuración del sistema, administración de gráficos y dashboards
   - Acceso a logs de auditoría y configuración de validaciones

2. **Gerente**
   
   - Gestión de contenido: crear/editar gráficos y dashboards
   - Ver usuarios y auditoría (sin modificar)
   - Sin acceso a configuración de sistema

3. **Analista**
   
   - Ver dashboards y gráficos
   - Exportar reportes
   - Sin acceso a edición de contenido
   
   

---

## Próximos Pasos

### Sprint 4 (Planeado)

- Publicación de dashboards para usuarios finales
- Sistema de notificaciones y alertas
- Exportación programada de reportes
- Optimizaciones de performance

### Backlog Técnico

- Migración a PostgreSQL 16 con mejoras de performance
- Implementación de Redis para caché de queries
- Dashboard de monitoreo técnico (Grafana)
- Tests de carga con JMeter

---

## Conclusiones

✅ **Sprint Goal alcanzado al 100%**

**Logros principales:**

- 4 historias de usuario completadas (37 Story Points)
- 70 tareas técnicas finalizadas:
  - Backend: 29 tareas (BE-TASK-40 a 68)
  - Frontend: 25 tareas (FE-TASK-31 a 55)
  - Testing: 10 tareas (TEST-TASK-05 a 14)
  - Documentación: 4 tareas (DOC-TASK-01 a 04)
  - DevOps: 3 tareas (OPS-TASK-01 a 03)
- 7 impedimentos resueltos con tiempo promedio de 2.0 días
- Sistema RBAC completamente funcional con permisos granulares
- Editor de dashboards drag-and-drop operativo
- Validación automática de datos configurable

**MVP Completo:** El sistema IOC ahora cuenta con las 4 capacidades core del administrador:

1. ✅ Validación de datos cargados
2. ✅ Gestión de usuarios y permisos
3. ✅ Administración de gráficos analíticos
4. ✅ Diseño de layout de dashboards

**Calidad del código:**

- Objetivos de cobertura de tests según Sprint Backlog
- Arquitectura escalable y mantenible
- Impedimentos resueltos con soluciones robustas documentadas

---

## Documentación de Referencia

**Documentos fuente (verificados):**

- Sprint Backlog Sprint 3 Completado (01-sprint_3_backlog_completado.md)
- Impediment Log Sprint 3 (04-impediment_log_sprint_3.md)
- Sprint Retrospective Sprint 3 (06-sprint_3_retrospective_v2_CORREGIDA.md)
- Project Summary (project-summary.md)

**Repositorio:**

- GitHub: https://github.com/qb4745/ioc-backend
- Branch principal: `main`
- Tag del sprint: `v3.0-sprint3-complete`

---

**Fecha de generación:** 18 Noviembre 2025  
**Versión:** 2.0 - Corregida  
**Estado:** Documento Simulado Educativo
